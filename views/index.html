<!DOCTYPE html>
<html>
    <head>
        <title>Kalkulator Zakat Maal</title>
        <script src="static/jquery-1.12.0.min.js"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
        <script>
            $(function () {
            	$("#user-form").on("submit", function (e) {
				    e.preventDefault();

				    var $self = $(this);
				    var payload = JSON.stringify({
				        wealth: parseInt($('[name="wealth"]').val(), 10),
				        line_name: $('[name="line_name"]').val()
				    });

				    $.ajax({
				        url: $self.attr("action"),
				        type: $self.attr("method"),
				        data: payload,
				        contentType: 'application/json',
				    }).then(function (res) {
				    	if (res[0]["Type"] == 0) {
					        $("#message2").hide();
					        $("#nama").text(res[0]["Name"]);
					        $("#harta").text(res[0]["Total_wealth"]);
					        $("#nisab").text(res[0]["Nisab"]);
					        $("#message1").show();
				        } else {
					        $("#message1").hide();
					        $("#nama2").text(res[0]["Name"]);
					        $("#harta2").text(res[0]["Total_wealth"]);
					        $("#nisab2").text(res[0]["Nisab"]);
					        $("#zakat2").text(res[0]["Zakat"]);
					        $("#message2").show();
					    }
				        //document.getElementById('message1').disabled = false;
				    }).catch(function (a) {
				        alert("ERROR: " + a.responseText);
				    });
				});
            });
        </script>
    </head>
    <body>
    	<h3 class="zakat_harta">Zakat Maal</h3>
    	<div class="info_zakat_harta">
			<p>Zakat Harta atau Zakat Maal adalah sejumlah harta yang wajib dikeluarkan bila telah mencapai batas minimal tertentu (nisab) dalam kurun waktu (haul) setiap satu tahun kalender. Nisab Zakat Maal adalah setara dengan 85 gr emas 24 karat.</p>
		</div>
        <div id="message1" hidden>Total harta <p style="font-weight: bold;" id="nama"></p> dalam kurun 1 tahun sebesar <p style="font-weight: bold;" id="harta"></p>, dan Nisab saat ini <p style="font-weight: bold;" id="nisab"></p>. Karena Total harta lebih kecil dari nisab anda tidak perlu membayar zakat</div>
        <div id="message2" hidden>Total harta <p style="font-weight: bold;" id="nama2"></p> dalam kurun 1 tahun sebesar <p style="font-weight: bold;" id="harta2"></p>, dan Nisab saat ini <p style="font-weight: bold;" id="nisab2"></p>. Karena total harta lebih besar dari nisab jadi zakat maal yang harus anda bayarkan sebesar <p style="font-weight: bold;" id="zakat2"></p></div>
        <form id="user-form" method="post" action="/save">
        	<table noborder>
			    <tr>
			        <td><label>Total Harta :</label></td>
			        <td>
			            <input required type="number" name="wealth" placeholder="Total Harta" />
			        </td>
			    </tr>
			    	<input id="displayNameField" type="hidden" name="line_name" value="">
			    <tr>
			        <td colspan="2" style="text-align: right;">
			            <button type="submit">Save</button>
			        </td>
			    </tr>
			</table>
        </form>
        <div id="liffAppContent">
            <div class="buttonGroup">
                <button id="liffLoginButton">Log in</button>
                <button id="liffLogoutButton">Log out</button>
            </div>
        </div>
        <script src="https://static.line-scdn.net/liff/edge/2.1/sdk.js"></script>
        <script src="static/liff-starter.js"></script>
        <!-- <script type="text/javascript">
        	document.getElementById('displayNameField').value = "beban";
        </script> -->
    </body>
</html>